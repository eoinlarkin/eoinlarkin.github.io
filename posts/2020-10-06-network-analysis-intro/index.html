<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.80.0" />


<title>Introduction to Network Analysis with R - Plots &amp; Numbers</title>
<meta property="og:title" content="Introduction to Network Analysis with R - Plots &amp; Numbers">


  <link href='https://eoinlarkin.github.io/favicon.ico' rel='icon' type='image/x-icon'/>



  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="../../css/fonts.css" media="all">
<link rel="stylesheet" href="../../css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="../../" class="nav-logo">
    <img src="../../images/logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="../../">Home</a></li>
    
    <li><a href="../../bookshelf/">Bookshelf</a></li>
    
    <li><a href="../../heatmaps/">Heatmaps</a></li>
    
    <li><a href="https://github.com/eoinlarkin/">GitHub</a></li>
    
    <li><a href="../../about/">About</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">4 min read</span>
    

    <h1 class="article-title">Introduction to Network Analysis with R</h1>

    
    <span class="article-date">2020-10-06</span>
    

    <div class="article-content">
      


<p>What is network analysis???</p>
<div id="code" class="section level2">
<h2>Code</h2>
<pre class="r"><code># Initial packages loaded
# Tidyverse loaded to facilitate manipulation of outputs

library(knitr)
library(igraph)
library(dplyr)
library(scales)
library(ggplot2)
library(tidyverse)</code></pre>
<pre class="r"><code># Loading the dataset
dataset &lt;- load(file.path(path, &quot;dataset.RData&quot;))

# Converting the data to graphs in igraph format
x_graph &lt;- graph.adjacency(X, mode=&quot;undirected&quot;)
y_graph &lt;- graph.adjacency(Y, mode=&quot;undirected&quot;, weighted=TRUE)</code></pre>
</div>
<div id="question-01-network-degrees" class="section level2">
<h2>Question 01: Network Degrees</h2>
<p>Having imported the graph, the degrees were calculated using the <code>degree</code> and <code>strength</code> function for the graphs derived from the <code>X</code> and <code>Y</code> adjacency matrices.</p>
<p>As <code>Y</code> is an interaction matrix, it corresponds to a weighted network and the <code>strength</code> function is used to calculate the degree of the nodes.</p>
<pre class="r"><code># Calculating the degrees
deg_x &lt;- degree(x_graph) # calculating the degrees
deg_y &lt;- strength(y_graph)

# Determining the top 5 degrees
deg_x_top5 &lt;- head(sort(deg_x, decreasing=TRUE),5)
deg_y_top5 &lt;- head(sort(deg_y, decreasing=TRUE),5)

# Five nodes with highest degree
vex_deg_top5 &lt;- V(x_graph)[match(deg_x_top5, deg_x)]

# Weighted degrees of five nodes with highest degree
vex_top5_wgt_deg &lt;- deg_y[match(deg_x_top5, deg_x)]</code></pre>
<p><strong>5 Nodes with Highest Binary Degree:</strong> 51, 272, 195, 195, 161</p>
<p><strong>Weighted degree of the 5 Nodes with Highest Binary Degree:</strong> 267, 123, 294, 294, 146</p>
</div>
<div id="question-02-network-visualisation" class="section level2">
<h2>Question 02: Network Visualisation</h2>
<p>The following plot provides a visual representation of the network <code>X</code> where the size of the nodes is proportional to the weighted degree, and the coordinates are coloured according to <code>time_frame</code>.</p>
<pre class="r"><code>plot(x_graph,
     layout = layout,
     edge.size = 1,
     edge.color=&quot;grey50&quot;,
     vertex.label=NA,
     vertex.size = 15 * rescale(deg_y, to=c(0,1)), # using a value of 20 and rescaling the vertex sizes
     vertex.color = time_frame,
     main=&quot;Network Graph of X&quot;)

legend(&quot;bottomright&quot;, legend=c(&quot;Time Frame 1&quot;, &quot;Time Frame 2&quot;, &quot;Time Frame 3&quot;),
       col=categorical_pal(8), pch=16, cex=1, bty=&quot;n&quot;)</code></pre>
<p><img src="index_files/figure-html/question_02-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="question-05-centrality-measures" class="section level2">
<h2>Question 05: Centrality Measures</h2>
<pre class="r"><code># Page Rank Centrality
x_page_rank &lt;- page_rank(x_graph)$vector # Page-Rank centrality
x_page_rank_top5 &lt;- V(x_graph)[order(x_page_rank, decreasing = T)[1:5]]

# Betweenness Centrality
x_between_centr &lt;- centr_betw(x_graph)$res # betweenness centrality
x_between_centr_top5 &lt;- V(x_graph)[order(x_between_centr,decreasing = T)[1:5]]</code></pre>
<ul>
<li><em>Page Rank Centrality - Top 5 Scores:</em> 0.0087931, 0.0079697, 0.0058721, 0.0057151, 0.0057093</li>
<li><em>Page Rank Centrality - Top 5 Nodes:</em> 51, 272, 235, 50, 195</li>
<li><em>Betweenness Centrality - Top 5 Scores:</em> 2.213394210^{4}, 1.683789110^{4}, 1.66315810^{4}, 9587.8048114, 6263.4480562</li>
<li><em>Betweenness Centrality - Top 5 Nodes:</em> 188, 272, 51, 230, 50</li>
</ul>
<p>The following plot illustrates the network with node sizes proportional to Page-Rank and highlights with a different colour the nodes that are in the top 10 according to both centralities.</p>
<pre class="r"><code># getting top 10 betweenness centrality indices
x_bc_index &lt;- order(x_between_centr, decreasing = T)[1:10]
# getting top 10 page-rank centrality indices
x_pr_index &lt;- order(x_page_rank, decreasing = T)[1:10]
# getting the list of indices which overlap
x_cc_index &lt;- intersect(x_bc_index, x_pr_index)

# Assigning colors for the igraph object
V(x_graph)$color = &quot;orange&quot;
V(x_graph)[x_bc_index]$color = &quot;blue4&quot;
V(x_graph)[x_pr_index]$color = &quot;aquamarine3&quot;
V(x_graph)[x_cc_index]$color = &quot;orangered2&quot;

plot(x_graph,
     layout = layout,
     edge.size = 1,
     edge.color=&quot;grey50&quot;,
     vertex.label = NA,
     vertex.size = 20 * rescale(x_page_rank, c(0,1)),
     main=&quot;Network Graph of X&quot;)

legend(&quot;bottomright&quot;, legend=c(&quot;Vertices&quot;, &quot;Top 10 Betweenness Centrality&quot;, &quot;Top 10 Page-Rank Centrality&quot;, &quot;Top 10 both Centrality Measures&quot;),
       col=c(&quot;orange&quot;,&quot;blue4&quot;, &quot;aquamarine3&quot;, &quot;orangered2&quot;), 
       pch= 16, 
       cex=1, bty=&quot;n&quot;)</code></pre>
<p><img src="index_files/figure-html/q05_02-1.png" width="672" /></p>
<p>We note that there are 4 nodes for which the Page-Rank Centrality and the Betweenness Centrality intersect. Of these</p>
<ul>
<li>2 are in time step 1</li>
<li>1 is in time step 2</li>
<li>1 is in time step 3</li>
</ul>
</div>
<div id="question-09-simulation-study-i" class="section level2">
<h2>Question 09: Simulation Study I</h2>
<pre class="r"><code>set.seed(1)
n_nodes_to_remove &lt;- 200 # number of nodes that we are removing from the network

# creates a vector with the index names for the nodes that will be removed
vertice_index &lt;- sample(V(x_graph), n_nodes_to_remove, replace=FALSE)

# this tibble store the output following the removal of each node
store_graph_metrics&lt;- tibble(nodes_removed = 0:200, 
                     largest_component = NA, 
                     clustering_coefficient = NA,
                     modularity= NA)

for(i in 0:n_nodes_to_remove){
                # Stores the network metrics before any nodes are removed
                if(i==0){ 
                        store_graph_metrics$largest_component[i+1] &lt;- max(degree(x_graph))
                        store_graph_metrics$clustering_coefficient[i+1] &lt;- modularity(x_graph, time_frame)
                        store_graph_metrics$modularity[i+1] &lt;- transitivity(x_graph)
                        }
                else{
                # Stores the network and memberships as we gradually remove nodes
                time_frame_temp &lt;- time_frame[-vertice_index[1:i]]
                x_graph_temp &lt;- igraph::delete.vertices(x_graph, vertice_index[1:i])
                
                # Writes the metrics to the tibble
                store_graph_metrics$largest_component[i+1] &lt;- max(degree(x_graph_temp))
                store_graph_metrics$clustering_coefficient[i+1] &lt;- modularity(x_graph_temp, time_frame_temp)
                store_graph_metrics$modularity[i+1] &lt;- transitivity(x_graph_temp)        
                }
        }

# Defining a function to plot the output
plot_sim &lt;- function(data, var, xlabel, title){
  ggplot(data=data, aes(x=nodes_removed, y=var)) +
    geom_line(color=&quot;red&quot;) +
    geom_point(size = 0.1) +
    xlab(&quot;Nodes Removed&quot;) +
    ylab(xlabel) +
    ggtitle(title)
    }

# Plotting the output
plot_sim(store_graph_metrics, 
         store_graph_metrics$largest_component, 
         &quot;Size of Largest Component&quot;, 
         &quot;Plot of Nodes Removed vs Largest Component&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>plot_sim(store_graph_metrics, 
         store_graph_metrics$clustering_coefficient, 
         &quot;Clustering Coefficient&quot;, 
         &quot;Plot of Nodes Removed vs Clustering Coefficient&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>plot_sim(store_graph_metrics, 
         store_graph_metrics$modularity, 
         &quot;Network Modularity&quot;, 
         &quot;Plot of Nodes Removed vs Network Modularity&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
<p>Examining the plots, we note the following:</p>
<ul>
<li><em>Largest Component:</em> This metric decreases as nodes are gradually removed from the network.</li>
<li><em>Clustering Coefficient:</em> This metric also decreases as nodes are gradually removed from the network. This behaviour is as expected, given the network contains a small number of highly connected nodes. However the trend is not strictly downwards, with some increases in the coefficient noted. As the clustering coefficient is a function of the nodes in the network and nodes are removed from the network at random it is not unexpected that this value can increase as nodes are removed.</li>
<li><em>Network Modularity:</em> The modularity is a measure of how clustered the network is. As nodes are removed at random, this measure both increases and decreases and does not strictly decrease.</li>
</ul>
</div>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="../../index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="../../images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="../../js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-173965746-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

